with met(num) as(values ('8442045'),
('8441322'),
('8441331'),
('8441340'),
('8441359'),
('8441368'),
('8441377'),
('8442054'),
('8442063'),
('8441475'),
('8442081'),
('8442090'),
('8442107'),
('8441386'),
('8441395'),
('8441402'),
('8441411'),
('8441420'),
('8441439'),
('8442296'),
('8442303'),
('8442312'),
('8442321'),
('8442330'),
('8442349'),
('8441448'),
('8441457'),
('8441466'),
('8441242'),
('8441493'),
('8442232'),
('8442241'),
('8442250'),
('8442269'),
('8442278'),
('8442287'),
('8441509'),
('8441518'),
('8441527'),
('8441536'),
('8441545'),
('8441554'),
('8442170'),
('8442189'),
('8442198'),
('8442205'),
('8442214'),
('8442223'),
('8441563'),
('8441572'),
('8441581'),
('8441590'),
('8441607'),
('8441616'),
('8442116'),
('8442125'),
('8442134'),
('8442143'),
('8442152'),
('8442161'),
('8441625'),
('8441634'),
('8441643'),
('8441652'),
('8441661'),
('8441670'),
('8442358'),
('8442367'),
('8442376'),
('8442385'),
('8442394'),
('8442401'),
('8441689'),
('8441698'),
('8441705'),
('8441714'),
('8441723'),
('8441732'),
('8442410'),
('8442429'),
('8442438'),
('8442447'),
('8442456'),
('8442465'),
('8441741'),
('8441750'),
('8441769'),
('8441778'),
('8441787'),
('8441796'),
('8442474'),
('8442483'),
('8442492'),
('8442508'),
('8442517'),
('8442526'),
('8441803'),
('8441812'),
('8441821'),
('8441830'),
('8441849'),
('8441858'),
('8442535'),
('8442544'),
('8442553'),
('8442562'),
('8442571'),
('8442580'),
('8441867'))

select distinct cu.customer_number num,
       st.name            stat,
       met.serial_number  met,
       mett.name,
       met.created_date
from public.prx_customer cu
join met m on m.num = cu.customer_number
left join public.prx_status st on cu.status_id = st.id
left join public.prx_customer_contract cuc on cuc.customer_id = cu.id
join public.prx_counter met on met.contract_id = cuc.id
left join prx_counter_type mett on met.type_id = mett.id
where   cu.deleted_by is null
  and cuc.deleted_by is null
  and met.deleted_by is null
  and st.deleted_by is null
  /*and cu.status_id in ('bc544f2d-057e-b375-7cb4-2f5850600e39', 'e1bf6037-c89e-e0ba-3f29-fa9fc84babca') --canceled, closed
  and (coalesce(met.serial_number, '') = '' or met.type_id = 'a690be13-1341-420f-2c46-a10099ee8fb6')--type=არა*/




